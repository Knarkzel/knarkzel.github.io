<!DOCTYPE html><html lang="en"><head><meta charset="UTF-8"/><title>Implementing opcodes</title><link rel="stylesheet" href="/styles.css"/></head><body><table width="100%" cellpadding="0" cellspacing="0" border="0" id="header"><td align="left"><b>Implementing opcodes</b> | <a href=../>Go back</a></td><td align="right">Written by <a href="https://github.com/knarkzel">Knarkzel</a></td></table><p>
After we have set up the screen, it's time to implement
<a href="https://web.archive.org/web/20230210094215/https://github.com/mattmikolay/chip-8/wiki/CHIP%E2%80%908-Instruction-Set">all the opcodes</a> that CHIP-8 uses. It's also necessary to set up
<a href="https://web.archive.org/web/20230210094317/https://github.com/mattmikolay/chip-8/wiki/CHIP%E2%80%908-Technical-Reference">registers and memory</a>. We will be using the <a href="https://web.archive.org/web/20230210094452/https://github.com/Timendus/chip8-test-suite">chip8-test-suite</a>
ROM to aid us in implementing the opcodes. When emulating each opcode,
we read two bytes at a time. Then we use pattern matching to see which
opcode it is and execute some code.
</p>

<div id="outline-container-org62c3161" class="outline-2">
<h2 id="org62c3161">CHIP-8 system</h2>
<div class="outline-text-2" id="text-org62c3161">
<p>
This is a brief summary of the CHIP-8 system:
</p>

<ul class="org-ul">
<li>CHIP-8 has 35 instructions. Every instruction is 2 bytes in size</li>
<li>CHIP-8 has 16 8-bit registers and one 16-bit address register</li>
<li>The stack is limited to 16 levels and is used to store the return address of subrutine calls</li>
<li>The memory is 4096 bytes in size, but only addressed from 0x200h to 0xFFFh</li>
<li>The display is monochrome and has a resolution of 64x32 pixels</li>
<li>CHIP-8 has 2 timers. A sound timer and a delay timer</li>
<li>The sound is very simple, only a beep</li>
<li>Input is done on 16 keys</li>
</ul>
</div>
</div>

<div id="outline-container-orgc8e8dac" class="outline-2">
<h2 id="orgc8e8dac">Goal for this article</h2>
<div class="outline-text-2" id="text-orgc8e8dac">
<p>
In this article, we'll implement following opcodes:
</p>

<table>


<colgroup>
<col  class="org-left">

<col  class="org-left">
</colgroup>
<thead>
<tr>
<th scope="col" class="org-left">Instruction</th>
<th scope="col" class="org-left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td class="org-left">00E0</td>
<td class="org-left">Clear the screen</td>
</tr>

<tr>
<td class="org-left">6XNN</td>
<td class="org-left">Store number NN in register VX</td>
</tr>

<tr>
<td class="org-left">ANNN</td>
<td class="org-left">Store memory address NNN in register I</td>
</tr>

<tr>
<td class="org-left">DXYN</td>
<td class="org-left">Draw a sprite at position VX, VY with N bytes of sprite data starting at the address stored in I. Set VF to 01 if any set pixels are changed to unset, and 00 otherwise</td>
</tr>
</tbody>
</table>

<p>
This is enough for us to get to the first stage of the chip8-test-suite
ROM, which is displaying the initial splash screen:
</p>


<div id="org8cda409" class="figure">
<p><img src="./splash-screen.png" alt="splash-screen.png">
</p>
</div>

<pre>
chip8
├── roms
│   └── <a href="./chip8/roms/chip8-test-suite.ch8">chip8-test-suite.ch8</a>
├── src
│   ├── <a href="./chip8/src/Emulator.zig">Emulator.zig</a>
│   ├── <a href="./chip8/src/main.zig">main.zig</a>
│   └── <a href="./chip8/src/Terminal.zig">Terminal.zig</a>
└── <a href="./chip8/build.zig">build.zig</a>
</pre>
</div>
</div>
</body></html>
